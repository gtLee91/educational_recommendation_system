# educational_recommendation_system

## Introduction
This project utilises deep learning and reinforcement learning to provide personalised course recommendations based on user data such as preferred exams, topics, target scores, and current proficiency levels.

## Install libraries
* Python 3.8+
* PyTorch 2.0.1+
* pandas 2.0.3
* sqlalchemy 2.0.21
* matplotlib 3.7.3
* sklearn 1.3.0

## folder & file description
**data**
- This folder gathers CSV files that have been generated by converting user profiles, course information, and rating data used in the recommendation system.

**result_img**
- This folder contains collected graph images depicting the results of model training and evaluation.

**trained_model**
- This folder collects pth files containing the states of trained models and optimization states.

**rs_engine.ipynb**
- This file implements the code for loading data into a CSV format.
- It is then composed of code for subsequent preprocessing steps, building a DRL (Deep Reinforcement Learning) model, training the model, and evaluating the model.

**merge_data.py**
- This code is responsible for retrieving user profiles, course information, and rating data from the database and performing the task of merging them into a unified dataset.

**data_pre_process.py**
- This code preprocesses the merged data.

**sequence_dataset.py**
- This code transforms the preprocessed data into sequence data.

**DRL_model.py**
- This code defines a neural network model with an LSTM-based Actor-Critic architecture.

**environment.py**
- This code defines an 'Environment' class to model a reinforcement learning environment

**train.py**
- This code performs the training of a Deep Reinforcement Learning (DRL) model.

**evaluation.py**
- This code evaluates a trained Deep Reinforcement Learning (DRL) model.

**testing.py, testing_env.py, testing_sq_dataset.py**
- These codes are created to conduct cold-start tests.

##solve problem
If you cannot access the database and retrieve the data, you can use a CSV file to load the data, as described in the rs_engine.ipynb
If you replace the code in merge_data.py with the following, you can load the data from a CSV file.
'''
import pandas as pd

cs_data_csv = pd.read_csv('data/course_information.csv')
cs_data = pd.DataFrame(cs_data_csv)
cs_data = cs_data.drop(['cs_content', 'cs_rating'], axis=1)
cs_data.rename(columns={'cs_num': 'item'}, inplace=True)

cs_rating = pd.read_csv('data/user_ratings.csv')
cs_rating_df = pd.DataFrame(cs_rating)
cs_rating_df.rename(columns={'UserID': 'user'}, inplace=True)
cs_rating_df.rename(columns={'Rating': 'rating'}, inplace=True)
cs_rating_df.rename(columns={'Timestamp': 'timestamp'}, inplace=True)
cs_rating_df.rename(columns={'CourseID': 'item'}, inplace=True)

user_profile = pd.read_csv('data/user_profiles.csv')
user_profile_df = pd.DataFrame(user_profile)
user_profile_df.rename(columns={'UserID': 'user'}, inplace=True)
user_profile_df.rename(columns={'PreferredCategory': 'pf_category'}, inplace=True)
user_profile_df.rename(columns={'PreferredTopic': 'pf_topic'}, inplace=True)
user_profile_df.rename(columns={'Level': 'pf_level'}, inplace=True)
user_profile_df.rename(columns={'PreferredStyle': 'pf_style'}, inplace=True)
user_profile_df.rename(columns={'AimScore': 'aimscore'}, inplace=True)
user_profile_df.rename(columns={'Gender': 'gender'}, inplace=True)
user_profile_df.rename(columns={'Age': 'age'}, inplace=True)

merged_df = pd.merge(cs_data, cs_rating_df, on='item', how='inner')
merged_df = pd.merge(merged_df, user_profile_df, on='user', how='inner')

desired_order = ['user','item','rating','cs_title','cs_category','cs_topic','cs_style','cs_level','pf_category','pf_topic','pf_style','pf_level','aimscore', 'age','gender','timestamp']
merged_df = merged_df[desired_order]

merged_df = merged_df.sort_values(["user","rating"]).fillna(0)
merged_df = merged_df.reset_index(drop=True)
print(merged_df.head(10))
'''

## Training DRL model
'''
%run train.py
'''

## Evaluation DRL model
'''
%run evaluation.py
'''

## cold-start test
'''
%run testing.py
'''
